# 人脸检测（机器学习方法）

### 人脸检测的基本流程

   人脸检测的任务就是判断给定的图像上是否存在人脸，如果人脸存在，就给出全部人脸所处的位置及其大小。其`步骤`一般是：
   
	1.选择图像上的某个（矩形）区域作为一个观察窗口；   

	2.在选定的窗口中提取一些特征对其包含的图像区域进行描述；   

	3.根据特征描述来判断这个窗口是不是正好框住了一张人脸。   

![](http://static.leiphone.com/uploads/new/article/740_740/201608/57a988991edf2.png?imageMogr2/format/jpg/quality/90)

###### 人脸窗口大小
1、采用多种不同大小的窗口，分别去扫描图像，但是这种做法并不高效。

2、将图像缩放到不同的大小，然后用相同大小的窗口去扫描——这就是所谓的构造图像金字塔的方式。
![](http://static.leiphone.com/uploads/new/article/740_740/201608/57a9889c89bba.png?imageMogr2/format/jpg/quality/90)
 
##### 特征提取
图像所提取的特征具体表示出来就是一个向量，称之为特征向量，其每一维是一个数值，这个数值是根据输入（图像区域）经由某些计算（观察）得到的，例如进行求和、相减、比较大小等。`HARR` `HOG` `LAP` `SURF`

##### 分类
先给分类器的参数设定一个初始值，然后让分类器通过训练集中带有“答案”（类别标签）的样例，不断去调整自己参数的取值，以缩小其实际的分类准确率和目标准确率之间的差距。


***
***

由于采用滑动窗口的方式需要在不同大小的图像上的每一个位置进行人脸和非人脸窗口的判别，而对于一张大小仅为480*320的输入图像，窗口总数就已经高达数十万，面对如此庞大的输入规模，如果对单个窗口进行特征提取和分类的速度不够快，就很容易使得整个检测过程产生巨大的时间开销。

### 人脸检测突破

人脸检测技术的突破发生在2001年，两位杰出的科研工作者Paul Viola和Michael Jones设计了出了一个快速而准确的人脸检测器：在获得相同甚至更好准确度的同时，速度提升了几十上百倍。

##### VJ人脸检测
VJ人脸检测之所以器能够获得成功，极大地提高人脸检测速度，其中有三个关键要素：

	特征的快速计算方法——积分图
	有效的分类器学习方法——AdaBoost
	以及高效的分类策略——级联结构的设计

![级联结构](http://static.leiphone.com/uploads/new/article/740_740/201608/57a988a2aa4b5.png?imageMogr2/format/jpg/quality/90)

每经过一级分类器，下一级分类器所需要判别的窗口就会减少，使得只需要付出非常少的计算代价就能够排除大部分非人脸窗口。

##### 特征的改进
虽然Haar特征已经能够刻画人脸的一些特点，但是相比于人脸复杂的变化模式，VJ人脸检测器所采用的5种Haar特征还是过于简单。

![](http://static.leiphone.com/uploads/new/article/740_740/201608/57a988a423a92.png?imageMogr2/format/jpg/quality/90)

##### 分类器的改进
分类器能力的强弱直接决定了分类准确度的高低，而分类的计算代价是影响检测速度的一个关键因素.
1)采用AdaBoost方法由弱分类器构建强分类器，这是一个顺序执行的过程，换言之，一旦一个弱分类器被选中，其就必定会成为强分类器的组成部分.事实上，每次对弱分类器的选择只是依照当时的情况决定，而随着新的弱分类器被增加进来，从整体上来看，之前的选择未必最优。基于这样的想法，出现了**允许回溯的FloatBoost**方法。
2)VJ人脸检测器中，相级联的多个分类器在学习的过程中并不会产生直接的联系，其关联仅体现在训练样例上：后一级分类器的训练样例一定要先通过前一级分类器。不同分类器在学习时的独立性会带来两方面的坏处：一是在每个分类器都是从头开始学习，不能借鉴之前已经学习好的分类器的经验；二是每个分类器在分类时都只能依靠自己，不能利用其它分类器已经获得的信息。出现了两种改进的方案：**链式Boosting方法和嵌套式Boosting方法**。3)相关的任务之间往往会相互产生促进作用，相辅相成，而和人脸检测密切相关的一个任务就是特征点定位：预测脸部关键点的位置，这些关键点可以是双眼中心、鼻尖、嘴角等。基于这样一种想法，在2014年出现了**Joint Cascade**，即把检测人脸所需要的分类器和预测特征点位置的回归器交替级联，同时进行人脸检测和特征点定位两个任务。

##### 级联结构的演化
不同姿态的人脸在表观特征上存在很大的差异，这给检测器带来了非常大的挑战，为了解决这一问题，通常采用分治的策略，即分别针对不同姿态的人脸单独训练分类器，然后组合起来构建成多姿态人脸检测器。 

金字塔式的级联结构也可以看成是一种特殊的并列式结构，只不过每个级联分类器相互之间有共享的部分，这样最直接的好处就在于减少了计算量，共享的部分只需要计算一次，同时在底层又保留了分治策略所带来的好处——子问题比原问题更加容易，因此更容易学习到分类准确度更高的分类器。   
![](http://static.leiphone.com/uploads/new/article/740_740/201608/57a988a5bc94f.png?imageMogr2/format/jpg/quality/90)

### 参考文献
[人脸检测发展：从VJ到深度学习](http://www.leiphone.com/news/201608/MPXlWtGaJLPYL7NB.html)
